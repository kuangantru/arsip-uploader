<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Uploader Arsip</title>
</head>
<body>

<h2>Uploader Arsip</h2>

<input type="file" id="file"><br><br>
<button onclick="uploadFile()">Upload ke Drive</button>

<p id="result"></p>

<script>
async function uploadFile() {
  const file = document.getElementById("file").files[0];
  if (!file) {
    alert("Pilih file terlebih dahulu!");
    return;
  }

  const reader = new FileReader();
  reader.onload = async () => {
    const base64 = reader.result.split(",")[1];

    const payload = {
      fileName: file.name,
      mimeType: file.type,
      fileData: base64
    };

    const res = await fetch(
      "https://script.google.com/macros/s/AKfycbwe8DM4LbbOnDJdbI3GuNiew6BedPAkwp4ch9PM1cUS0HcNpXCx2n_k11DEN41EvlETRg/exec",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },  // <--- WAJIB
        body: JSON.stringify(payload)
      }
    );

    const text = await res.text();
    console.log("Raw response:", text);

    try {
      const data = JSON.parse(text);
      document.getElementById("result").innerText = JSON.stringify(data, null, 2);
    } catch (e) {
      document.getElementById("result").innerText = "Response bukan JSON:\n" + text;
    }
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
