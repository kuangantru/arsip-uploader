<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Uploader Arsip</title>
</head>
<body>

<h2>Uploader Arsip</h2>

<input type="file" id="file"><br><br>
<button onclick="uploadFile()">Upload ke Drive</button>

<p id="result"></p>

<script>
async function uploadFile() {
  const file = document.getElementById("file").files[0];
  if (!file) {
    alert("Pilih file terlebih dahulu!");
    return;
  }

  const reader = new FileReader();
  reader.onload = async () => {
    const base64 = reader.result.split(",")[1];

    const payload = {
      fileName: file.name,
      mimeType: file.type,
      fileData: base64
    };

    const res = await fetch(
      "https://script.google.com/macros/s/AKfycbzIZgx5GSOo4giFOcZwzNTuP-UQerqdzL-J4XvYl-U7V871-rqfLHO3tVruuQnTYZ959Q/exec",
      {
        method: "POST",
        body: JSON.stringify(payload)
      }
    );

    const data = await res.json();
    document.getElementById("result").innerText = JSON.stringify(data);
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
