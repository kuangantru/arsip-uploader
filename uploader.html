<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Uploader ke Google Drive</title>
</head>
<body>

  <h2>Upload File ke Google Drive</h2>

  <input type="file" id="fileInput"><br><br>
  <button onclick="uploadFile()">Upload</button>

  <p id="status"></p>
  <p id="result"></p>

<script>
async function uploadFile() {
    const fileInput = document.getElementById("fileInput");
    const status = document.getElementById("status");
    const result = document.getElementById("result");

    if (fileInput.files.length === 0) {
        alert("Pilih file dulu!");
        return;
    }

    const file = fileInput.files[0];

    status.innerText = "Uploading...";

    const url = "https://script.google.com/macros/s/AKfycby_CHQfdiLEdmoou8b_pwvMAnWcytBZC5EdTdErDjdtsRBSgAt1knIFdKZS0b5D4HkB/exec";

    const formData = new FormData();
    formData.append("file", file);
    formData.append("filename", file.name);

    let response = await fetch(url, {
        method: "POST",
        body: formData
    });

    let data = await response.json();

    if (data.status === "success") {
        status.innerText = "Upload berhasil âœ”";
        result.innerHTML = `<a href="${data.url}" target="_blank">Lihat File</a>`;
    } else {
        status.innerText = "Gagal upload";
        result.innerText = data.message;
    }
}
</script>

</body>
</html>
